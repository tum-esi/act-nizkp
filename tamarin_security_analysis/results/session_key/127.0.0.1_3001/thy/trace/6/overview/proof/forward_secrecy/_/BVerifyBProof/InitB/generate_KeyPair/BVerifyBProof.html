<!DOCTYPE html>
<html>
<!-- Mirrored from 127.0.0.1:3001/thy/trace/6/overview/proof/forward_secrecy/_/BVerifyBProof/InitB/generate_KeyPair/BVerifyBProof by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 07 Jul 2023 18:20:44 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><title>Theory: session_key_agreement</title><link rel="stylesheet" href="../../../../../../../../../../static/css/tamarin-prover-ui.css"><link rel="stylesheet" href="../../../../../../../../../../static/css/jquery-contextmenu.css"><link rel="stylesheet" href="../../../../../../../../../../static/css/smoothness/jquery-ui.css"><script src="../../../../../../../../../../static/js/jquery.js"></script></script><script src="../../../../../../../../../../static/js/jquery-ui.js"></script></script><script src="../../../../../../../../../../static/js/jquery-layout.js"></script></script><script src="../../../../../../../../../../static/js/jquery-cookie.js"></script></script><script src="../../../../../../../../../../static/js/jquery-superfish.js"></script></script><script src="../../../../../../../../../../static/js/jquery-contextmenu.js"></script></script><script src="../../../../../../../../../../static/js/tamarin-prover-ui.js"></script></script></head><body><p class="loading">Loading, please wait...  <a id=cancel href='#'>Cancel</a></p><div class="ui-layout-north"><div class="layout-pane-north"><div id="header-info">Running <a href=http://127.0.0.1:3001/><span class="tamarin">Tamarin</span></a> 1.6.1</div></div><div id="header-links"><a class="plain-link" href="http://127.0.0.1:3001/">Index</a></a><a class="plain-link" href="http://127.0.0.1:3001/thy/trace/6/download/session_key_agreement.spthy">Download</a></a><ul id="navigation"><li><a href="#">Actions</a><ul><li><a target=_blank href=http://127.0.0.1:3001/thy/trace/6/source>Show source</a></li></ul></li><li><a href="#">Options</a><ul><li><a id=abbrv-toggle href="#">Abbreviate terms</a></li><li><a id=lvl0-toggle href="#">Graph simplification off</a></li><li><a id=lvl1-toggle href="#">Graph simplification L1</a></li><li><a id=lvl2-toggle href="#">Graph simplification L2</a></li><li><a id=lvl3-toggle href="#">Graph simplification L3</a></li></ul></li></ul></div></div><div class="ui-layout-west"><h1 class="pane-head">Proof scripts</h1><div class="scroll-wrapper" id="proof-wrapper"><div class="monospace" id="proof"><span class="hl_keyword">theory</span> <a class="internal-link help" href="http://127.0.0.1:3001/thy/trace/6/main/help">session_key_agreement</a> <span class="hl_keyword">begin</span><br/>
<br/>
<a class="internal-link" href="http://127.0.0.1:3001/thy/trace/6/main/message"><strong>Message theory</strong> </a><br/>
<br/>
<a class="internal-link" href="http://127.0.0.1:3001/thy/trace/6/main/rules"><strong>Multiset rewriting rules and restrictions</strong> (13)</a><br/>
<br/>
<a class="internal-link" href="http://127.0.0.1:3001/thy/trace/6/main/cases/raw/0/0"><strong>Raw sources</strong> (20 cases, deconstructions complete)</a><br/>
<br/>
<a class="internal-link" href="http://127.0.0.1:3001/thy/trace/6/main/cases/refined/0/0"><strong>Refined sources </strong> (20 cases, deconstructions complete)</a><br/>
<br/>
<span class="hl_good"><span class="hl_keyword">lemma</span> executable:<br/>
&nbsp;&nbsp;exists-trace<br/>
&nbsp;&nbsp;&quot;<span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">∃ </span>A B #i1 #i2 #i3 #i4 #i5 #i7 skA skB ssk Aproof<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Bproof<span class="hl_operator">.</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">(</span>HonestKey( A, skA ) <span class="hl_operator">@</span> #i1<span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>HonestKey( B, skB ) <span class="hl_operator">@</span> #i2<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>HonestSharedKey( A, B, ssk ) <span class="hl_operator">@</span> #i3<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>ACreatedSchnorrZKPForWitness( A, skA ) <span class="hl_operator">@</span> #i4<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>BVerifiedAsProofAndBCreatedSchnorrZKPForWitness( B, Aproof, skB<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <span class="hl_operator">@</span> #i5<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>AVerifiedSchnorrZKPForProof( A, Bproof ) <span class="hl_operator">@</span> #i7<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>#i1 <span class="hl_operator">&lt;</span> #i3<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>#i2 <span class="hl_operator">&lt;</span> #i3<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>#i3 <span class="hl_operator">&lt;</span> #i4<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>#i4 <span class="hl_operator">&lt;</span> #i5<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>#i5 <span class="hl_operator">&lt;</span> #i7<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span><span class="hl_operator">∀ </span>#i #j<span class="hl_operator">.</span> <span class="hl_operator">(</span><span class="hl_operator">(</span>InitA( ) <span class="hl_operator">@</span> #i<span class="hl_operator">)</span> <span class="hl_operator">∧</span> <span class="hl_operator">(</span>InitA( ) <span class="hl_operator">@</span> #j<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">⇒</span> <span class="hl_operator">(</span>#i <span class="hl_operator">=</span> #j<span class="hl_operator">)</span><span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span><span class="hl_operator">∀ </span>#i #j<span class="hl_operator">.</span> <span class="hl_operator">(</span><span class="hl_operator">(</span>InitB( ) <span class="hl_operator">@</span> #i<span class="hl_operator">)</span> <span class="hl_operator">∧</span> <span class="hl_operator">(</span>InitB( ) <span class="hl_operator">@</span> #j<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">⇒</span> <span class="hl_operator">(</span>#i <span class="hl_operator">=</span> #j<span class="hl_operator">)</span><span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span><span class="hl_operator">∃ </span>A B idA idB #i #j<span class="hl_operator">.</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span><span class="hl_operator">(</span>CreateA( A, idA ) <span class="hl_operator">@</span> #i<span class="hl_operator">)</span> <span class="hl_operator">∧</span> <span class="hl_operator">(</span>CreateB( B, idB ) <span class="hl_operator">@</span> #j<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span><span class="hl_operator">¬</span><span class="hl_operator">(</span>A <span class="hl_operator">=</span> B<span class="hl_operator">)</span><span class="hl_operator">)</span><span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span><span class="hl_operator">¬</span><span class="hl_operator">(</span><span class="hl_operator">∃ </span>A idA #i #j<span class="hl_operator">.</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>CreateA( A, idA ) <span class="hl_operator">@</span> #i<span class="hl_operator">)</span> <span class="hl_operator">∧</span> <span class="hl_operator">(</span>RevealSecret( A ) <span class="hl_operator">@</span> #j<span class="hl_operator">)</span><span class="hl_operator">)</span><span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span><span class="hl_operator">¬</span><span class="hl_operator">(</span><span class="hl_operator">∃ </span>B idB #i #j<span class="hl_operator">.</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>CreateB( B, idB ) <span class="hl_operator">@</span> #i<span class="hl_operator">)</span> <span class="hl_operator">∧</span> <span class="hl_operator">(</span>RevealSecret( B ) <span class="hl_operator">@</span> #j<span class="hl_operator">)</span><span class="hl_operator">)</span><span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span><span class="hl_operator">¬</span><span class="hl_operator">(</span><span class="hl_operator">∃ </span>A B idA idB #i #j #l<span class="hl_operator">.</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span><span class="hl_operator">(</span>CreateA( A, idA ) <span class="hl_operator">@</span> #i<span class="hl_operator">)</span> <span class="hl_operator">∧</span> <span class="hl_operator">(</span>CreateB( B, idB ) <span class="hl_operator">@</span> #j<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>RevealSharedSecret( A, B ) <span class="hl_operator">@</span> #l<span class="hl_operator">)</span><span class="hl_operator">)</span><span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span><span class="hl_operator">¬</span><span class="hl_operator">(</span><span class="hl_operator">∃ </span>A B shared_session_key #i #j #k<span class="hl_operator">.</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">(</span>SessionKey( A, B, shared_session_key ) <span class="hl_operator">@</span> #i<span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>SessionKey( B, A, shared_session_key ) <span class="hl_operator">@</span> #j<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>#j <span class="hl_operator">&lt;</span> #i<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>K( shared_session_key ) <span class="hl_operator">@</span> #k<span class="hl_operator">)</span><span class="hl_operator">)</span><span class="hl_operator">)</span>&quot;</span><br/>
<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/executable"><span class="hl_keyword">simplify</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/executable"></a><br/>
<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/executable/_"><span class="hl_keyword">solve(</span> AState1( $A, id, ~skA, multp(~skA), ssk.1 ) ▶₀ #i4 <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/executable/_"></a><br/>
&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> InitA</span><br/>
&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/executable/_/InitA"><span class="hl_keyword">solve(</span> BState1( $A.1, id.1, ~skA.1, multp(~skA.1), ssk.2 ) ▶₀ #i5 <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/executable/_/InitA"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> InitB</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/executable/_/InitA/InitB"><span class="hl_keyword">solve(</span> !PubKey( $A.2, APK ) ▶₁ #i5 <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/executable/_/InitA/InitB"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> generate_KeyPair</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/executable/_/InitA/InitB/generate_KeyPair"><span class="hl_keyword">solve(</span> AState2( $A, id.2, ssk.3, rr_A, R_A.1 ) ▶₀ #i7 <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/executable/_/InitA/InitB/generate_KeyPair"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> AProof</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/executable/_/InitA/InitB/generate_KeyPair/AProof"><span class="hl_keyword">solve(</span> !PubKey( $B.1, BPK ) ▶₁ #i7 <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/executable/_/InitA/InitB/generate_KeyPair/AProof"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> generate_KeyPair</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/executable/_/InitA/InitB/generate_KeyPair/AProof/generate_KeyPair"><span class="hl_keyword">solve(</span> !KU( MAC(~ssk.2, &lt;R_A, plus($counter.1, one)&gt;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <span class="hl_operator">@</span> #vk.6 <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/executable/_/InitA/InitB/generate_KeyPair/AProof/generate_KeyPair"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> c_MAC</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/executable/_/InitA/InitB/generate_KeyPair/AProof/generate_KeyPair/c_MAC"><span class="hl_keyword">solve(</span> !KU( ~ssk.2 ) <span class="hl_operator">@</span> #vk.14 <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/executable/_/InitA/InitB/generate_KeyPair/AProof/generate_KeyPair/c_MAC"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> reveal_shared_secretKey</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/executable/_/InitA/InitB/generate_KeyPair/AProof/generate_KeyPair/c_MAC/reveal_shared_secretKey"><span class="hl_keyword">solve(</span> !KU( MAC(~ssk, &lt;multp(~r_A), R_B, $counter.2&gt;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <span class="hl_operator">@</span> #vk.14 <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/executable/_/InitA/InitB/generate_KeyPair/AProof/generate_KeyPair/c_MAC/reveal_shared_secretKey"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> c_MAC</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/executable/_/InitA/InitB/generate_KeyPair/AProof/generate_KeyPair/c_MAC/reveal_shared_secretKey/c_MAC"><span class="hl_keyword">solve(</span> !KU( ~ssk ) <span class="hl_operator">@</span> #vk.17 <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/executable/_/InitA/InitB/generate_KeyPair/AProof/generate_KeyPair/c_MAC/reveal_shared_secretKey/c_MAC"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> reveal_shared_secretKey</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/executable/_/InitA/InitB/generate_KeyPair/AProof/generate_KeyPair/c_MAC/reveal_shared_secretKey/c_MAC/reveal_shared_secretKey"><span class="hl_keyword">solve(</span> !KU( plus($counter.1, one) ) <span class="hl_operator">@</span> #vk.18 <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/executable/_/InitA/InitB/generate_KeyPair/AProof/generate_KeyPair/c_MAC/reveal_shared_secretKey/c_MAC/reveal_shared_secretKey"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> c_plus</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/executable/_/InitA/InitB/generate_KeyPair/AProof/generate_KeyPair/c_MAC/reveal_shared_secretKey/c_MAC/reveal_shared_secretKey/c_plus"><span class="hl_keyword">solve(</span> !KU( multp(~r_A) ) <span class="hl_operator">@</span> #vk.19 <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/executable/_/InitA/InitB/generate_KeyPair/AProof/generate_KeyPair/c_MAC/reveal_shared_secretKey/c_MAC/reveal_shared_secretKey/c_plus"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> AProof</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/executable/_/InitA/InitB/generate_KeyPair/AProof/generate_KeyPair/c_MAC/reveal_shared_secretKey/c_MAC/reveal_shared_secretKey/c_plus/AProof"><span class="hl_keyword">SOLVED</span> <span class="hl_comment">// trace found</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/executable/_/InitA/InitB/generate_KeyPair/AProof/generate_KeyPair/c_MAC/reveal_shared_secretKey/c_MAC/reveal_shared_secretKey/c_plus/AProof"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
<br/>
<span class="hl_good"><span class="hl_keyword">lemma</span> zero_knowledge:<br/>
&nbsp;&nbsp;all-traces<br/>
&nbsp;&nbsp;&quot;<span class="hl_operator">¬</span><span class="hl_operator">(</span><span class="hl_operator">∃ </span>A B skA skB zkproof_A #i1 #i2 #i3 #i4<span class="hl_operator">.</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">(</span>ACreatedSchnorrZKPForWitness( A, skA ) <span class="hl_operator">@</span> #i1<span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>BVerifiedAsProofAndBCreatedSchnorrZKPForWitness( B, zkproof_A, skB<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <span class="hl_operator">@</span> #i2<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span><span class="hl_operator">¬</span><span class="hl_operator">(</span>A <span class="hl_operator">=</span> B<span class="hl_operator">)</span><span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>K( skA ) <span class="hl_operator">@</span> #i3<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>K( skB ) <span class="hl_operator">@</span> #i4<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span><span class="hl_operator">¬</span><span class="hl_operator">(</span><span class="hl_operator">∃ </span>#i #j<span class="hl_operator">.</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>RevealSecret( A ) <span class="hl_operator">@</span> #i<span class="hl_operator">)</span> <span class="hl_operator">∧</span> <span class="hl_operator">(</span>RevealSecret( B ) <span class="hl_operator">@</span> #j<span class="hl_operator">)</span><span class="hl_operator">)</span><span class="hl_operator">)</span><span class="hl_operator">)</span>&quot;</span><br/>
<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/zero_knowledge"><span class="hl_keyword">simplify</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/zero_knowledge"></a><br/>
<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/zero_knowledge/_"><span class="hl_keyword">solve(</span> AState1( A, id, skA, multp(skA), ssk ) ▶₀ #i1 <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/zero_knowledge/_"></a><br/>
&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> InitA</span><br/>
&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/zero_knowledge/_/InitA"><span class="hl_keyword">solve(</span> BState1( B, id.1, skB, multp(skB), ssk.1 ) ▶₀ #i2 <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/zero_knowledge/_/InitA"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> InitB</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/zero_knowledge/_/InitA/InitB"><span class="hl_keyword">solve(</span> !PubKey( $A.1, APK ) ▶₁ #i2 <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/zero_knowledge/_/InitA/InitB"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> generate_KeyPair</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/zero_knowledge/_/InitA/InitB/generate_KeyPair"><span class="hl_keyword">solve(</span> !KU( ~skA ) <span class="hl_operator">@</span> #vk.7 <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/zero_knowledge/_/InitA/InitB/generate_KeyPair"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> reveal_secretKey</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/zero_knowledge/_/InitA/InitB/generate_KeyPair/reveal_secretKey"><span class="hl_keyword">solve(</span> !KU( ~skA.1 ) <span class="hl_operator">@</span> #vk.8 <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/zero_knowledge/_/InitA/InitB/generate_KeyPair/reveal_secretKey"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> reveal_secretKey</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">by</span> </span><a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/zero_knowledge/_/InitA/InitB/generate_KeyPair/reveal_secretKey/reveal_secretKey"><span class="hl_keyword">contradiction</span> <span class="hl_comment">/* from formulas */</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/zero_knowledge/_/InitA/InitB/generate_KeyPair/reveal_secretKey/reveal_secretKey"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
<br/>
<span class="hl_good"><span class="hl_keyword">lemma</span> session_key_secrecy:<br/>
&nbsp;&nbsp;all-traces<br/>
&nbsp;&nbsp;&quot;<span class="hl_operator">∀ </span>A B shared_session_key #i #j<span class="hl_operator">.</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">(</span>SessionKey( A, B, shared_session_key ) <span class="hl_operator">@</span> #i<span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>SessionKey( B, A, shared_session_key ) <span class="hl_operator">@</span> #j<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>#j <span class="hl_operator">&lt;</span> #i<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span><span class="hl_operator">¬</span><span class="hl_operator">(</span>A <span class="hl_operator">=</span> B<span class="hl_operator">)</span><span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">⇒</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span><span class="hl_operator">¬</span><span class="hl_operator">(</span><span class="hl_operator">∃ </span>#k<span class="hl_operator">.</span> K( shared_session_key ) <span class="hl_operator">@</span> #k<span class="hl_operator">)</span><span class="hl_operator">)</span>&quot;</span><br/>
<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/session_key_secrecy"><span class="hl_keyword">simplify</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/session_key_secrecy"></a><br/>
<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/session_key_secrecy/_"><span class="hl_keyword">solve(</span> SessionKey( A, B, shared_session_key ) <span class="hl_operator">@</span> #i <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/session_key_secrecy/_"></a><br/>
&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> AVerify</span><br/>
&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/session_key_secrecy/_/AVerify"><span class="hl_keyword">solve(</span> AState2( A, id, ssk, rr_A, R_A ) ▶₀ #i <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/session_key_secrecy/_/AVerify"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> AProof</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/session_key_secrecy/_/AVerify/AProof"><span class="hl_keyword">solve(</span> !PubKey( $B, BPK ) ▶₁ #i <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/session_key_secrecy/_/AVerify/AProof"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> generate_KeyPair</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/session_key_secrecy/_/AVerify/AProof/generate_KeyPair"><span class="hl_keyword">solve(</span> SessionKey( $B, $A, genSessionKey(~r_A, R_B) ) <span class="hl_operator">@</span> #j <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/session_key_secrecy/_/AVerify/AProof/generate_KeyPair"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> AVerify</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/session_key_secrecy/_/AVerify/AProof/generate_KeyPair/AVerify"><span class="hl_keyword">solve(</span> AState2( $B, id.1, ssk.1, ~r_A, R_A ) ▶₀ #j <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/session_key_secrecy/_/AVerify/AProof/generate_KeyPair/AVerify"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> AProof</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">by</span> </span><a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/session_key_secrecy/_/AVerify/AProof/generate_KeyPair/AVerify/AProof"><span class="hl_keyword">contradiction</span> <span class="hl_comment">/* cyclic */</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/session_key_secrecy/_/AVerify/AProof/generate_KeyPair/AVerify/AProof"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
<span class="hl_good"><span class="hl_keyword">next</span></span><br/>
&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> BVerifyBProof</span><br/>
&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/session_key_secrecy/_/BVerifyBProof"><span class="hl_keyword">solve(</span> BState1( A, id, skB, multp(skB), ssk ) ▶₀ #i <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/session_key_secrecy/_/BVerifyBProof"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> InitB</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/session_key_secrecy/_/BVerifyBProof/InitB"><span class="hl_keyword">solve(</span> !PubKey( $A, APK ) ▶₁ #i <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/session_key_secrecy/_/BVerifyBProof/InitB"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> generate_KeyPair</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/session_key_secrecy/_/BVerifyBProof/InitB/generate_KeyPair"><span class="hl_keyword">solve(</span> SessionKey( $A, $B, genSessionKey(~r_B, R_A) ) <span class="hl_operator">@</span> #j <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/session_key_secrecy/_/BVerifyBProof/InitB/generate_KeyPair"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> AVerify</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">by</span> </span><a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/session_key_secrecy/_/BVerifyBProof/InitB/generate_KeyPair/AVerify"><span class="hl_keyword">solve(</span> AState2( $A, id.1, ssk.1, ~r_B, R_A.1 ) ▶₀ #j <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/session_key_secrecy/_/BVerifyBProof/InitB/generate_KeyPair/AVerify"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">next</span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> BVerifyBProof</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">by</span> </span><a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/session_key_secrecy/_/BVerifyBProof/InitB/generate_KeyPair/BVerifyBProof"><span class="hl_keyword">contradiction</span> <span class="hl_comment">/* cyclic */</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/session_key_secrecy/_/BVerifyBProof/InitB/generate_KeyPair/BVerifyBProof"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
<br/>
<span class="hl_good"><span class="hl_keyword">lemma</span> forward_secrecy:<br/>
&nbsp;&nbsp;all-traces<br/>
&nbsp;&nbsp;&quot;<span class="hl_operator">∀ </span>A B shared_session_key_1 shared_session_key_2 #i1 #i2 #i3<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#i4 #k1<span class="hl_operator">.</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">(</span><span class="hl_operator">(</span>SessionKey( B, A, shared_session_key_1 ) <span class="hl_operator">@</span> #i1<span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>SessionKey( A, B, shared_session_key_1 ) <span class="hl_operator">@</span> #i2<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>SessionKey( B, A, shared_session_key_2 ) <span class="hl_operator">@</span> #i3<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>SessionKey( A, B, shared_session_key_2 ) <span class="hl_operator">@</span> #i4<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>#i1 <span class="hl_operator">&lt;</span> #i2<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>#i2 <span class="hl_operator">&lt;</span> #i3<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>#i3 <span class="hl_operator">&lt;</span> #i4<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span><span class="hl_operator">¬</span><span class="hl_operator">(</span>A <span class="hl_operator">=</span> B<span class="hl_operator">)</span><span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>K( shared_session_key_2 ) <span class="hl_operator">@</span> #k1<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>#i4 <span class="hl_operator">&lt;</span> #k1<span class="hl_operator">)</span><span class="hl_operator">)</span> <span class="hl_operator">⇒</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span><span class="hl_operator">¬</span><span class="hl_operator">(</span><span class="hl_operator">∃ </span>#k2<span class="hl_operator">.</span> K( shared_session_key_1 ) <span class="hl_operator">@</span> #k2<span class="hl_operator">)</span><span class="hl_operator">)</span>&quot;</span><br/>
<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/forward_secrecy"><span class="hl_keyword">simplify</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/forward_secrecy"></a><br/>
<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/forward_secrecy/_"><span class="hl_keyword">solve(</span> SessionKey( B, A, shared_session_key_1 ) <span class="hl_operator">@</span> #i1 <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/forward_secrecy/_"></a><br/>
&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> AVerify</span><br/>
&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/forward_secrecy/_/AVerify"><span class="hl_keyword">solve(</span> AState2( B, id, ssk, rr_A, R_A ) ▶₀ #i1 <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/forward_secrecy/_/AVerify"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> AProof</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/forward_secrecy/_/AVerify/AProof"><span class="hl_keyword">solve(</span> !PubKey( $B, BPK ) ▶₁ #i1 <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/forward_secrecy/_/AVerify/AProof"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> generate_KeyPair</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/forward_secrecy/_/AVerify/AProof/generate_KeyPair"><span class="hl_keyword">solve(</span> SessionKey( $B, $A, genSessionKey(~r_A, R_B) ) <span class="hl_operator">@</span> #i2 <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/forward_secrecy/_/AVerify/AProof/generate_KeyPair"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> AVerify</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/forward_secrecy/_/AVerify/AProof/generate_KeyPair/AVerify"><span class="hl_keyword">solve(</span> AState2( $B, id.1, ssk.1, ~r_A, R_A ) ▶₀ #i2 <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/forward_secrecy/_/AVerify/AProof/generate_KeyPair/AVerify"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> AProof</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">by</span> </span><a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/forward_secrecy/_/AVerify/AProof/generate_KeyPair/AVerify/AProof"><span class="hl_keyword">contradiction</span> <span class="hl_comment">/* cyclic */</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/forward_secrecy/_/AVerify/AProof/generate_KeyPair/AVerify/AProof"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
<span class="hl_good"><span class="hl_keyword">next</span></span><br/>
&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> BVerifyBProof</span><br/>
&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/forward_secrecy/_/BVerifyBProof"><span class="hl_keyword">solve(</span> BState1( B, id, skB, multp(skB), ssk ) ▶₀ #i1 <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/forward_secrecy/_/BVerifyBProof"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> InitB</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/forward_secrecy/_/BVerifyBProof/InitB"><span class="hl_keyword">solve(</span> !PubKey( $A, APK ) ▶₁ #i1 <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/forward_secrecy/_/BVerifyBProof/InitB"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> generate_KeyPair</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/forward_secrecy/_/BVerifyBProof/InitB/generate_KeyPair"><span class="hl_keyword">solve(</span> SessionKey( $A, $B, genSessionKey(~r_B, R_A) ) <span class="hl_operator">@</span> #i2 <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/forward_secrecy/_/BVerifyBProof/InitB/generate_KeyPair"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> AVerify</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">by</span> </span><a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/forward_secrecy/_/BVerifyBProof/InitB/generate_KeyPair/AVerify"><span class="hl_keyword">solve(</span> AState2( $A, id.1, ssk.1, ~r_B, R_A.1 ) ▶₀ #i2 <span class="hl_keyword">)</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/forward_secrecy/_/BVerifyBProof/InitB/generate_KeyPair/AVerify"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">next</span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">case</span> BVerifyBProof</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">by</span> </span><a class="internal-link proof-step hl_good" href="http://127.0.0.1:3001/thy/trace/6/main/proof/forward_secrecy/_/BVerifyBProof/InitB/generate_KeyPair/BVerifyBProof"><span class="hl_keyword">contradiction</span> <span class="hl_comment">/* cyclic */</span></a><a class="internal-link remove-step" href="http://127.0.0.1:3001/thy/trace/6/main/proof/forward_secrecy/_/BVerifyBProof/InitB/generate_KeyPair/BVerifyBProof"></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
&nbsp;&nbsp;<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
<span class="hl_good"><span class="hl_keyword">qed</span></span><br/>
<br/>
<span class="hl_keyword">end</span><br/>
 </div></div></div><div class="ui-layout-east"><h1 class="pane-head">&nbsp;Debug information</h1><div class="scroll-wrapper" id="debug-wrapper"><div id="ui-debug-display"></div></div></div><div class="ui-layout-center"><h1 class="pane-head" id="main-title">Visualization display</h1><div class="scroll-wrapper" id="main-wrapper" tabindex="0"><div id="ui-main-display"><h3>Applicable Proof Methods: <span class="hl_comment">Goals sorted according to the &#39;smart&#39; heuristic (loop breakers delayed)</span></h3><br/>
<div class="preformatted methods">1. <a class="internal-link proof-method" href="http://127.0.0.1:3001/thy/trace/6/main/method/forward_secrecy/1/_/BVerifyBProof/InitB/generate_KeyPair/BVerifyBProof"><span class="hl_keyword">contradiction</span> <span class="hl_comment">/* cyclic */</span></a><br/>
<br/>
2. <a class="internal-link proof-method" href="http://127.0.0.1:3001/thy/trace/6/main/method/forward_secrecy/2/_/BVerifyBProof/InitB/generate_KeyPair/BVerifyBProof"><span class="hl_keyword">contradiction</span> <span class="hl_comment">/* from formulas */</span></a><br/>
<br/>
3. <a class="internal-link proof-method" href="http://127.0.0.1:3001/thy/trace/6/main/method/forward_secrecy/3/_/BVerifyBProof/InitB/generate_KeyPair/BVerifyBProof"><span class="hl_keyword">solve(</span> SessionKey( $A, $A, shared_session_key_2<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <span class="hl_operator">@</span> #i3 <span class="hl_keyword">)</span></a> <span class="hl_comment">// nr. 2</span><br/>
<br/>
4. <a class="internal-link proof-method" href="http://127.0.0.1:3001/thy/trace/6/main/method/forward_secrecy/4/_/BVerifyBProof/InitB/generate_KeyPair/BVerifyBProof"><span class="hl_keyword">solve(</span> SessionKey( $A, $A, shared_session_key_2<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <span class="hl_operator">@</span> #i4 <span class="hl_keyword">)</span></a> <span class="hl_comment">// nr. 3</span><br/>
<br/>
5. <a class="internal-link proof-method" href="http://127.0.0.1:3001/thy/trace/6/main/method/forward_secrecy/5/_/BVerifyBProof/InitB/generate_KeyPair/BVerifyBProof"><span class="hl_keyword">solve(</span> !KU( genSessionKey(~r_B, R_A) ) <span class="hl_operator">@</span> #vk.1 <span class="hl_keyword">)</span></a> <span class="hl_comment">// nr. 19</span><br/>
<br/>
6. <a class="internal-link proof-method" href="http://127.0.0.1:3001/thy/trace/6/main/method/forward_secrecy/6/_/BVerifyBProof/InitB/generate_KeyPair/BVerifyBProof"><span class="hl_keyword">solve(</span> !KU( MAC(~ssk, &lt;R_A, plus($counter, one)&gt;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <span class="hl_operator">@</span> #vk.7 <span class="hl_keyword">)</span></a> <span class="hl_comment">// nr. 21</span></div><br/>
a. <a class="internal-link autoprove" href="http://127.0.0.1:3001/thy/trace/6/autoprove/idfs/0/proof/forward_secrecy/_/BVerifyBProof/InitB/generate_KeyPair/BVerifyBProof"><span class="hl_keyword">autoprove</span></a> (A. <a class="internal-link characterization" href="http://127.0.0.1:3001/thy/trace/6/autoprove/characterize/0/proof/forward_secrecy/_/BVerifyBProof/InitB/generate_KeyPair/BVerifyBProof"><span class="hl_keyword">for all solutions</span></a>)<br/>
b. <a class="internal-link bounded-autoprove" href="http://127.0.0.1:3001/thy/trace/6/autoprove/idfs/5/proof/forward_secrecy/_/BVerifyBProof/InitB/generate_KeyPair/BVerifyBProof"><span class="hl_keyword">autoprove</span></a> (B. <a class="internal-link bounded-characterization" href="http://127.0.0.1:3001/thy/trace/6/autoprove/characterize/5/proof/forward_secrecy/_/BVerifyBProof/InitB/generate_KeyPair/BVerifyBProof"><span class="hl_keyword">for all solutions</span></a>)  with proof-depth bound 5<br/>
s. <a class="internal-link autoprove-all" href="http://127.0.0.1:3001/thy/trace/6/autoproveAll/idfs/0/proof/forward_secrecy/_/BVerifyBProof/InitB/generate_KeyPair/BVerifyBProof"><span class="hl_keyword">autoprove</span></a> (S. <a class="internal-link characterization-all" href="http://127.0.0.1:3001/thy/trace/6/autoproveAll/characterize/0/proof/forward_secrecy/_/BVerifyBProof/InitB/generate_KeyPair/BVerifyBProof"><span class="hl_keyword">for all solutions</span></a>)  for all lemmas <br/>
<br/>
<h3>Constraint system</h3><br/>
<img class="graph" src="../../../../../../../graph/proof/forward_secrecy/_/BVerifyBProof/InitB/generate_KeyPair/BVerifyBProof.png"/><br/>
<div class="preformatted sequent"><span class="hl_keyword">last</span>: none<br/>
<br/>
<span class="hl_keyword">formulas</span>:<br/>
&nbsp;&nbsp;<span class="hl_operator">⊥</span><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="hl_operator">∀</span> #i w r cl cr pkey R<span class="hl_operator">.</span><br/>
&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>ValidSchnorrZKP( schnorrZKProof(w, r, cl), pkey, R, cr ) <span class="hl_operator">@</span> #i<span class="hl_operator">)</span><br/>
&nbsp;&nbsp;<span class="hl_operator">⇒</span><br/>
&nbsp;&nbsp;&nbsp;<span class="hl_operator">∃</span> m n<span class="hl_operator">.</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>pkey <span class="hl_operator">=</span> multp(m)<span class="hl_operator">)</span><span class="hl_operator"> ∧</span> <span class="hl_operator">(</span>R <span class="hl_operator">=</span> multp(n)<span class="hl_operator">)</span><span class="hl_operator"> ∧</span> <span class="hl_operator">(</span>m <span class="hl_operator">=</span> w<span class="hl_operator">)</span><span class="hl_operator"> ∧</span> <span class="hl_operator">(</span>n <span class="hl_operator">=</span> r<span class="hl_operator">)</span><span class="hl_operator"> ∧</span> <span class="hl_operator">(</span>cl <span class="hl_operator">=</span> cr<span class="hl_operator">)</span><br/>
<br/>
<span class="hl_keyword">equations</span>:<br/>
&nbsp;&nbsp;<span class="hl_keyword">subst</span>:<br/>
&nbsp;&nbsp;<span class="hl_keyword">conj</span>:<br/>
<br/>
<span class="hl_keyword">lemmas</span>: <span class="hl_operator">∀</span> x y #i<span class="hl_operator">.</span> <span class="hl_operator">(</span>Eq( x, y ) <span class="hl_operator">@</span> #i<span class="hl_operator">)</span> <span class="hl_operator">⇒</span> x <span class="hl_operator">=</span> y<br/>
<br/>
<span class="hl_keyword">allowed cases</span>: refined<br/>
<br/>
<span class="hl_keyword">solved formulas</span>:<br/>
&nbsp;&nbsp;trueMAC <span class="hl_operator">=</span> trueMAC<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="hl_operator">(</span><span class="hl_operator">∃</span> A B shared_session_key_1 shared_session_key_2 #i1 #i2 #i3 #i4<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#k1<span class="hl_operator">.</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>SessionKey( B, A, shared_session_key_1 ) <span class="hl_operator">@</span> #i1<span class="hl_operator">)</span><span class="hl_operator"> ∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>SessionKey( A, B, shared_session_key_1 ) <span class="hl_operator">@</span> #i2<span class="hl_operator">)</span><span class="hl_operator"> ∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>SessionKey( B, A, shared_session_key_2 ) <span class="hl_operator">@</span> #i3<span class="hl_operator">)</span><span class="hl_operator"> ∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>SessionKey( A, B, shared_session_key_2 ) <span class="hl_operator">@</span> #i4<span class="hl_operator">)</span><span class="hl_operator"> ∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>K( shared_session_key_2 ) <span class="hl_operator">@</span> #k1<span class="hl_operator">)</span><br/>
&nbsp;&nbsp;&nbsp;<span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>#i1 <span class="hl_operator">&lt;</span> #i2<span class="hl_operator">)</span><span class="hl_operator"> ∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>#i2 <span class="hl_operator">&lt;</span> #i3<span class="hl_operator">)</span><span class="hl_operator"> ∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>#i3 <span class="hl_operator">&lt;</span> #i4<span class="hl_operator">)</span><span class="hl_operator"> ∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span><span class="hl_operator">¬</span><span class="hl_operator">(</span>A <span class="hl_operator">=</span> B<span class="hl_operator">)</span><span class="hl_operator">)</span><span class="hl_operator"> ∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>#i4 <span class="hl_operator">&lt;</span> #k1<span class="hl_operator">)</span><span class="hl_operator"> ∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span><span class="hl_operator">∃</span> #k2<span class="hl_operator">.</span> <span class="hl_operator">(</span>K( shared_session_key_1 ) <span class="hl_operator">@</span> #k2<span class="hl_operator">)</span><span class="hl_operator">)</span><span class="hl_operator">)</span><span class="hl_operator"> ∧</span><br/>
&nbsp;&nbsp;<span class="hl_operator">(</span><span class="hl_operator">∀</span> #i w r cl cr pkey R<span class="hl_operator">.</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>ValidSchnorrZKP( schnorrZKProof(w, r, cl), pkey, R, cr ) <span class="hl_operator">@</span> #i<span class="hl_operator">)</span><br/>
&nbsp;&nbsp;&nbsp;<span class="hl_operator">⇒</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">∃</span> m n<span class="hl_operator">.</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>pkey <span class="hl_operator">=</span> multp(m)<span class="hl_operator">)</span><span class="hl_operator"> ∧</span> <span class="hl_operator">(</span>R <span class="hl_operator">=</span> multp(n)<span class="hl_operator">)</span><span class="hl_operator"> ∧</span> <span class="hl_operator">(</span>m <span class="hl_operator">=</span> w<span class="hl_operator">)</span><span class="hl_operator"> ∧</span> <span class="hl_operator">(</span>n <span class="hl_operator">=</span> r<span class="hl_operator">)</span><span class="hl_operator"> ∧</span> <span class="hl_operator">(</span>cl <span class="hl_operator">=</span> cr<span class="hl_operator">)</span><span class="hl_operator">)</span><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="hl_operator">¬</span><span class="hl_operator">(</span>$A <span class="hl_operator">=</span> $A<span class="hl_operator">)</span><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="hl_operator">∃</span> A B shared_session_key_1 shared_session_key_2 #i1 #i2 #i3 #i4<br/>
&nbsp;&nbsp;&nbsp;&nbsp;#k1<span class="hl_operator">.</span><br/>
&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>SessionKey( B, A, shared_session_key_1 ) <span class="hl_operator">@</span> #i1<span class="hl_operator">)</span><span class="hl_operator"> ∧</span><br/>
&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>SessionKey( A, B, shared_session_key_1 ) <span class="hl_operator">@</span> #i2<span class="hl_operator">)</span><span class="hl_operator"> ∧</span><br/>
&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>SessionKey( B, A, shared_session_key_2 ) <span class="hl_operator">@</span> #i3<span class="hl_operator">)</span><span class="hl_operator"> ∧</span><br/>
&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>SessionKey( A, B, shared_session_key_2 ) <span class="hl_operator">@</span> #i4<span class="hl_operator">)</span><span class="hl_operator"> ∧</span><br/>
&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>K( shared_session_key_2 ) <span class="hl_operator">@</span> #k1<span class="hl_operator">)</span><br/>
&nbsp;&nbsp;<span class="hl_operator">∧</span><br/>
&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>#i1 <span class="hl_operator">&lt;</span> #i2<span class="hl_operator">)</span><span class="hl_operator"> ∧</span><br/>
&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>#i2 <span class="hl_operator">&lt;</span> #i3<span class="hl_operator">)</span><span class="hl_operator"> ∧</span><br/>
&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>#i3 <span class="hl_operator">&lt;</span> #i4<span class="hl_operator">)</span><span class="hl_operator"> ∧</span><br/>
&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span><span class="hl_operator">¬</span><span class="hl_operator">(</span>A <span class="hl_operator">=</span> B<span class="hl_operator">)</span><span class="hl_operator">)</span><span class="hl_operator"> ∧</span><br/>
&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span>#i4 <span class="hl_operator">&lt;</span> #k1<span class="hl_operator">)</span><span class="hl_operator"> ∧</span><br/>
&nbsp;&nbsp;&nbsp;<span class="hl_operator">(</span><span class="hl_operator">∃</span> #k2<span class="hl_operator">.</span> <span class="hl_operator">(</span>K( shared_session_key_1 ) <span class="hl_operator">@</span> #k2<span class="hl_operator">)</span><span class="hl_operator">)</span><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="hl_operator">∃</span> #k2<span class="hl_operator">.</span> <span class="hl_operator">(</span>K( genSessionKey(~r_B, R_A) ) <span class="hl_operator">@</span> #k2<span class="hl_operator">)</span><br/>
<br/>
<span class="hl_keyword">unsolved goals</span>:<br/>
&nbsp;&nbsp;SessionKey( $A, $A, shared_session_key_2<br/>
&nbsp;&nbsp;) <span class="hl_operator">@</span> #i3 <span class="hl_comment">// nr: 2&quot; (useful2)&quot;</span><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;SessionKey( $A, $A, shared_session_key_2<br/>
&nbsp;&nbsp;) <span class="hl_operator">@</span> #i4 <span class="hl_comment">// nr: 3&quot; (useful2)&quot;</span><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;!KU( shared_session_key_2<br/>
&nbsp;&nbsp;) <span class="hl_operator">@</span> #vk <span class="hl_comment">// nr: 8&quot; (probably constructible)&quot;</span><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;!KU( genSessionKey(~r_B, R_A)<br/>
&nbsp;&nbsp;) <span class="hl_operator">@</span> #vk.1 <span class="hl_comment">// nr: 19&quot; (useful2)&quot;</span><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;!KU( $counter ) <span class="hl_operator">@</span> #vk.2 <span class="hl_comment">// nr: 13&quot; (currently deducible)&quot;</span><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;!KU( &lt;proof_A, R_A, MAC(~ssk, &lt;R_A, plus($counter, one)&gt;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;<br/>
&nbsp;&nbsp;) <span class="hl_operator">@</span> #vk.3 <span class="hl_comment">// nr: 14&quot; (useful2)&quot;</span><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;!KU( proof_A<br/>
&nbsp;&nbsp;) <span class="hl_operator">@</span> #vk.4 <span class="hl_comment">// nr: 15&quot; (probably constructible)&quot;</span><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;!KU( &lt;R_A, MAC(~ssk, &lt;R_A, plus($counter, one)&gt;)&gt;<br/>
&nbsp;&nbsp;) <span class="hl_operator">@</span> #vk.5 <span class="hl_comment">// nr: 16&quot; (useful2)&quot;</span><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;!KU( R_A ) <span class="hl_operator">@</span> #vk.6 <span class="hl_comment">// nr: 37&quot; (probably constructible)&quot;</span><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;!KU( MAC(~ssk, &lt;R_A, plus($counter, one)&gt;)<br/>
&nbsp;&nbsp;) <span class="hl_operator">@</span> #vk.7 <span class="hl_comment">// nr: 21&quot; (useful2)&quot;</span><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;Disj <span class="hl_operator">(⊥)</span> <span class="hl_comment">// nr: 41&quot; (useful2)&quot;</span><br/>
<br/>
<span class="hl_keyword">solved goals</span>:<br/>
&nbsp;&nbsp;SessionKey( $A, $A, genSessionKey(~r_B, R_A)<br/>
&nbsp;&nbsp;) <span class="hl_operator">@</span> #i1 <span class="hl_comment">// nr: 0 (from rule BVerifyBProof)&quot; (useful2)&quot;</span><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;K( shared_session_key_2<br/>
&nbsp;&nbsp;) <span class="hl_operator">@</span> #k1 <span class="hl_comment">// nr: 4 (from rule Send)&quot; (useful2)&quot;</span><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;K( genSessionKey(~r_B, R_A)<br/>
&nbsp;&nbsp;) <span class="hl_operator">@</span> #k2 <span class="hl_comment">// nr: 5 (from rule Send)&quot; (useful2)&quot;</span><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;!PubKey( $A, multp(~skA.1)<br/>
&nbsp;&nbsp;) ▶₀ #i1 <span class="hl_comment">// nr: 26 (from rule BVerifyBProof)&quot; (useful2)&quot;</span><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;BState1( $A, ~id, ~skA, multp(~skA), ~ssk<br/>
&nbsp;&nbsp;) ▶₀ #i1 <span class="hl_comment">// nr: 11 (from rule BVerifyBProof)&quot; (useful2)&quot;</span><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;!PubKey( $A, multp(~skA.1)<br/>
&nbsp;&nbsp;) ▶₁ #i1 <span class="hl_comment">// nr: 12 (from rule BVerifyBProof)&quot; (useful2)&quot;</span><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;!SecretKey( $A, ~skA<br/>
&nbsp;&nbsp;) ▶₁ #vr <span class="hl_comment">// nr: 23 (from rule InitB)&quot; (useful2)&quot;</span><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;!PubKey( $A, multp(~skA)<br/>
&nbsp;&nbsp;) ▶₂ #vr <span class="hl_comment">// nr: 24 (from rule InitB)&quot; (useful2)&quot;</span><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;!SharedSecretKey( $A.1, $A, ~ssk<br/>
&nbsp;&nbsp;) ▶₃ #vr <span class="hl_comment">// nr: 25 (from rule InitB)&quot; (useful2)&quot;</span></div><br/>
<h3>0 sub-case(s)</h3><br/>
 </div></div></div><div id="dialog"></div><ul id="contextMenu"><li class="autoprove"><a href="#autoprove">Autoprove</a></a></li></ul></body>
<!-- Mirrored from 127.0.0.1:3001/thy/trace/6/overview/proof/forward_secrecy/_/BVerifyBProof/InitB/generate_KeyPair/BVerifyBProof by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 07 Jul 2023 18:20:56 GMT -->
</html>